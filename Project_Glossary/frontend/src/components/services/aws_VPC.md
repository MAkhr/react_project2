# Amazon VPC

Virtual Private Cloud。AWS上に独立したネットワーク環境を構築できます。
ネットワーク環境のまとまりで、複数のAZに配置することが可能。

## 主な特徴
- 論理的に分離されたネットワーク
- サブネット、ルートテーブル設定可能
- セキュリティグループでアクセス制御
- インターネットゲートウェイ接続

## 主なサービス
- VPCピアリング

    VPCピアリングは、異なるVPCからインターネットを経由せずに同じネットワークにいるように通信ができるサービス

- ネットワークACL（アクセスコントロールリスト）

    サブネット間の制御として使われる。ネットワークACLはインバウンド設定とアウトバウンドの両方を設定する必要がある。

    ＜デフォルトの設定＞

        インバウンド　：すべて許可
        アウトバウンド：すべて許可

    ネットワークACLルールの評価方法は、低い値から高い値に順番に評価され、低い値が優先される。

    捕捉:

        SSH接続　：ポートは22、インバウンドのため「Egress：false」に設定されていること

        特定のIPのみ：サブネットは「/32」
        アウトバウンドを広範囲のPCに設定する：ポート「1024~65535」

- セキュリティグループ

    インスタンスなどに適用するファイアウォール機能で、主にV PCリソースのトラフィックを制御
    セキュリティグループにはCIDRを指定してIPアドレス範囲を設定するか、別のセキュリティグループIDも設定可能

    デフォルトの設定

        インバウンド　：すべて拒否
        アウトバウンド：すべて許可

    *ネットワークACLとセキュリティグループの違い

        セキュリティグループはインスタンス単位で設定
        ネットワークACLはサブネット単位で設定

        セキュリティグループはステートフル（ルールで許可された通信の戻りの通信も自動的に許可）
        ネットワークACLはステートレス（アウトバウンド/インバウンドそれぞれで、ルール設定が必要）

- VPCの上限

    1リージョンあたり5VPC。
    申請フォームによりAWSに申請すれば100まで上げることが可能

- NATゲートウェイ

    プライベートサブネットにあるEC2インスタンスからセキュアなインターネットへのアクセスが必要な場合に使用。
    ルートテーブルで指定してあげる。

    💡トラフィックミラーリング
    ミラー対象に指定したENI（Elastic Network Interface）を通るトラフィックの中身をミラーリング。
    ミラーリングしたパケットを、別のENIやNLB、GWLBに対して転送することができるので、パケットをモニタリングすることが可能

- Elastic Network Interface（ENI）

    仮想ネットワーク。
    ENIはインスタンスにアタッチされている。
    デタッチしてつけ変えも可能

- AWS Network Firewall

    インターネットやVPC間との通信を検査及び制御

- DNS hostnamesオプション

    パブリックサブネットでEC2インスタンスを起動した際に、インスタンスがDNS名を受け取らない場合、DNS hostnamesオプションを有効化

- AZ

    AZはデータセンターの集まり。リージョン内で物理的に区分され独立しています。AZは物理的に分離されているため、火災、竜巻、洪水などの極端な災害は単一AZのみに影響する。

    リージョン > AZ > データセンター

- エッジロケーション

    低レイテンシーを達成するため、キャッシュコンテンツを配信するための地理的ロケーションのこと。ファイル圧縮処理などが可能。

[公式ドキュメント](https://docs.aws.amazon.com/vpc/)